/*! For license information please see app.min.js.LICENSE.txt */
(()=>{"use strict";const e="f0312cfa-6c00-4b71-84b6-534ea2e1bdff";async function n(n,i){const o=n+i,s=await fetch(o,{method:"GET",headers:{"Content-Type":"application/json","X-API-KEY":`${e}`}});!function(e,n){const i=document.querySelector(".movies");document.querySelector(".movies").innerHTML="",e.films.forEach((e=>{const n=document.createElement("div");n.classList.add("movie"),n.innerHTML=`\n        <a href = "view.html?id=${e.filmId}">\n            <div class="movie__cover-inner">\n                <img class="movie__cover" src="${e.posterUrlPreview}" alt ="${e.nameRu}">\n                <div class="movie__cover--darkened"></div> \n            </div>\n        </a>\n            <div class="movie__info">\n                <div class="movie__title">${e.nameRu}</div>\n                <div class="movie__category">${e.genres.map((e=>` ${e.genre}`))}</div>\n                <div class="movie__rating movie__rating--${function(e){const n=+t(e);return n>=7?"green":n>4?"orange":n?"red":"white"}(e.rating)}">${t(e.rating)}</div>\n            </div>\n    `,i.append(n)}))}(await s.json())}function t(e){return-1!=e.indexOf("%")?(parseInt(e)/10).toFixed(1):"null"==e?"":e}const i=document.location.search.slice(4);function o(e){let n=e;return n=n>10?(n/10).toFixed(2):n,+n}function s(e){const n=+o(e);return n>=7?"green":n>4?"orange":n?"red":"white"}function a(){this.dataset.close?this.dataset.close&&(this.children[1].classList.remove("open"),this.dataset.close=""):(this.children[1].classList.add("open"),this.dataset.close=!0)}function c(e){const n=function(e){const n=document.createElement("div");return n.style.width=`${e.width}`,n.classList.add("modal"),n.innerHTML=`\n        \n            <div class="modal-overlay" data-close = "true">\n                <div class="modal-window" style = "width:${e.width||"600"}px">\n                <div class = "modal-container ${e.modalStyle}">\n                    <div class="modal-header ${e.modalStyle}">\n                        <h3 class="modal-title">${e.title||""}</h3>\n                        ${e.subtitle&&`<span class="modal-subtitle">${e.subtitle}</span>`||""}\n                        ${e.closable?'<span class="modal-close" data-close = "true">&times</span>':""}\n                    </div>\n                    <div class="modal-body ${e.modalStyle}">\n                        ${e.content||""}\n                    </div>\n                    <div class="modal-footer">\n                        ${e.footer}\n                    </div>\n                </div>\n            </div>\n        </div>`,document.body.appendChild(n),n}(e);let t=!1,i=!1;const o={open(){if(i)return console.log("modal is destroyed");!t&&n.classList.add("open")},close(){t=!0,n.classList.remove("open"),n.classList.add("hide"),setTimeout((()=>{n.classList.remove("hide"),t=!1}),500)}},s=e=>{e.target.dataset.close&&(o.close(),o.destroy())};return n.addEventListener("click",s),Object.assign(o,{destroy(){n.parentNode.removeChild(n),n.removeEventListener("click",s),i=!0}})}var d,l;"/view.html"==document.location.pathname&&async function(n){const t=`https://kinopoiskapiunofficial.tech/api/v2.2/films/${n}`,i=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","X-API-KEY":`${e}`}});(function(e,n){const t=document.querySelector(`.${n}`);document.querySelector(`.${n}`).innerHTML="";const i=document.createElement("div");i.classList.add("movie-description"),i.innerHTML=`\n        <h1 class="movie-description__title">${e.nameRu}</h1>\n        <h2 class="movie-description__title en">${e.nameOriginal||""}</h2>\n        <div class="video-info">\n            <span class="video-info__year">${e.year},</span>\n            <span class="video-info__genres">${e.genres.map((e=>` ${e.genre}`))},</span>\n            <span class="video-info__country">${e.countries[0].country}</span>\n         </div>\n        <div class="movie-description__time">Время: ${e.filmLength||"110"} минут</div>\n        <div class="movie-description__rating">Ожидаемый рейтинг:<span class="movie-description__rating--${s(e.ratingAwait)}"> ${o(e.ratingAwait)||""}</span></div> \n        <div class="movie-description__rating">Рейтинг:<span class="movie-description__rating--${s(e.ratingKinopoisk)}"> ${e.ratingKinopoisk||""}</span></div>\n        <div class="movie-description__description"> ${e.description}\n        </div>\n    `,t.append(i)})(await i.json(),"movie-content-inner"),async function(n){const t=`https://kinopoiskapiunofficial.tech/api/v2.2/films/${n}/similars`,i=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json","X-API-KEY":`${e}`}}),o=await i.json();console.log(o),function(e,n){const t=document.querySelector(`.${n}`);document.querySelector(`.${n}`).innerHTML="",e.items.forEach((e=>{const n=document.createElement("div");n.classList.add("movie"),n.innerHTML=`\n        <a href = "view.html?id=${e.filmId}">\n            <div class="movie__cover-inner">\n                <img class="movie__cover" src="${e.posterUrlPreview}" alt ="${e.nameRu}">\n                <div class="movie__cover--darkened"></div> \n            </div>\n        </a>\n            <div class="movie__info">\n                <div class="movie__title">${e.nameRu}</div>\n            </div>\n    `,t.append(n)}))}(o,"movieRecomended__content")}(n)}(i),d=function(e){let n=!0===e?"webp":"no-webp";document.documentElement.classList.add(n)},(l=new Image).onload=l.onerror=function(){d(2==l.height)},l.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";const r="https://kinopoiskapiunofficial.tech/api/v2.2/films/top?type=TOP_100_POPULAR_FILMS&page=";document.querySelector(".main-title")&&n(r,1);const m=document.querySelector("form"),v=document.querySelector(".header__search");m.addEventListener("submit",(e=>{e.preventDefault();const t=`https://kinopoiskapiunofficial.tech/api/v2.1/films/search-by-keyword?keyword=${v.value}`;v.value&&(n(t,1),v.value="")}));const u=document.querySelectorAll(".pageNumber");for(let e of u)e.addEventListener("click",(()=>{const t=e.firstElementChild.innerHTML;u.forEach((e=>e.classList.remove("active"))),e.classList.add("active"),n(r,t)}));const p={width:"380",title:"Вход",subtitle:"Регистрация",borderHeader:!0,closable:!0,modalStyle:"small-window",content:'\n    <div class = "auth-info"> Для входа введите email или номер телефона </div> \n    <form> <input class = "auth-input" type = "text" placeholder = "Номер телефона" tabindex = "1"> </form> \n    <form> <input class= "auth-input" type="text" placeholder = "Пароль" tabindex = "2"> </form>\n    <div class = "auth-form-remember"> \n    <label><input type = "checkbox" checked = "checked" tabindex = "3"> Запомнить меня </label>\n    </div>\n    ',footer:'<div class = "form-action"> <button class = "btn" tabindex = "4"> Войти</button></div>'};document.querySelector(".header__auth-link").addEventListener("click",(()=>{const e=c(p);e.open(),document.querySelector(".modal-subtitle").addEventListener("click",(()=>{const n=c(h);e.destroy(),n.open()}))}));const h={width:"380",title:"Регистрация",subtitle:"",borderHeader:!0,closable:!0,modalStyle:"small-window",content:'\n    <div class = "auth-info"> Для регистрации введите ваш номер телефона и пароль</div> \n    <form> <input class = "auth-input" type = "text" placeholder = "Номер телефона" tabindex = "1"> </form> \n    <form> <input class= "auth-input" type="text" placeholder = "Пароль" tabindex = "2"> </form>\n    <div class = "auth-rules"> Нажимая кнопку "Зарегистрироваться" вы принимаете условия <a href = "#">Пользовательского \n    соглашения и Политики обработки персональных данных </a>\n    </div>\n    ',footer:'<div class = "form-action"> <button class = "btn" tabindex = "4"> Зарегистрироваться </button></div>'},f=document.querySelectorAll(".nav-item");for(let e=0;e<f.length;e++)f[e].addEventListener("click",a)})();